

Necesito implementar correctamente el sistema de subusuarios (empleados) sin guardar contraseñas manualmente.

Arquitectura requerida:

1) El empleador ya está autenticado con Firebase Auth. (ya lo hicimos)
2) Cada empleador puede crear una cierta cantidad de empleados (depende del plan que tiene activo actualmente, se debe revisar para envitar que pase la cantidad permitda)
3) Los empleados deben:
   - Tener cuenta real en Firebase Authentication
   - Recibir email de verificación automáticamente
   - No poder ingresar si emailVerified == false
4) No se deben guardar contraseñas en Firestore.
5) Firestore solo debe almacenar:
   - uid
   - role (empleador | empleado)
   - comercioId
   - createdAt
   -nombre de usuario (lo crea el empleador)
   -mail del empleador (asi lo reconozco facilmente)

Requisitos técnicos:

A) Crear una Cloud Function llamada crearEmpleado: (creo que ya la creaste anteriormente)
   - Verificar que el usuario autenticado sea role = empleador.
   - Verificar que no supere la cantidad de empleados permitida para su subcripción
   - Crear usuario en Firebase Auth con email y contraseña temporal.
   - Enviar email de verificación automáticamente.
   - Guardar documento en Firestore en:
     empleados/{uidEmpleado}
   con:
     role: "empleado"
     comercioId: comercio del empleador
     createdAt: serverTimestamp()

B) En el login del frontend: (recorda que esta en index.html )
   - Bloquear acceso si user.emailVerified == false.
   - Mostrar mensaje: "Debes verificar tu correo antes de ingresar."

C) Agregar reglas de seguridad Firestore:(creo que algunas ya las agregamos)
   - Solo usuarios autenticados pueden leer sus propios datos.
   - Un empleado solo puede acceder a documentos donde comercioId coincida con el suyo.
   - Validar request.auth.token.email_verified == true.

La implementación debe:
- No usar contraseñas en texto plano.
- No validar seguridad desde el frontend.
- Usar admin.auth() en Cloud Functions.
- Ser segura para producción.
